# Dockerfile.test
FROM python:3.11-slim

WORKDIR /app

# Dependencias mínimas para tests
COPY requirements.txt /app/requirements.txt
RUN pip install --upgrade pip \
 && pip install -r /app/requirements.txt \
 && pip install pytest httpx

# Copiar código y tests
COPY app /app/app
COPY tests /app/tests
COPY pytest.ini /app/pytest.ini

# Asegurar que /app esté en el PYTHONPATH
ENV PYTHONPATH=/app

# Ejecutar tests
CMD ["python", "-m", "pytest", "-q"]
